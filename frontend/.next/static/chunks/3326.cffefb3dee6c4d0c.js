"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3326],{33326:function(e,t,n){n.d(t,{baseAccount:function(){return o},safe:function(){return u}});var a=n(53738),i=n(13102),r=n(31669),c=n(59455),s=n(77014);function o(e={}){let t,o,d,h;return(0,a.K)(a=>({id:"baseAccount",name:"Base Account",rdns:"app.base.account",type:"baseAccount",async connect({chainId:e,withCapabilities:t,...n}={}){try{let u=await this.getProvider(),l=e??a.chains[0]?.id;if(!l)throw new i.X4;let{accounts:w,currentChainId:m}=await (async()=>{if(n.isReconnecting)return{accounts:(await u.request({method:"eth_accounts",params:[]})).map(e=>({address:(0,r.K)(e)})),currentChainId:await this.getChainId()};let e=await u.request({method:"wallet_connect",params:[{capabilities:"capabilities"in n&&n.capabilities?n.capabilities:{},chainIds:[(0,c.eC)(l),...a.chains.filter(e=>e.id!==l).map(e=>(0,c.eC)(e.id))]}]});return{accounts:(await u.request({method:"eth_accounts"})).map(t=>e.accounts.find(e=>e.address===t)??{address:t}).map(e=>({address:(0,r.K)(e.address),capabilities:e.capabilities??{}})),currentChainId:Number(e.chainIds[0])}})();if(o||(o=this.onAccountsChanged.bind(this),u.on("accountsChanged",o)),d||(d=this.onChainChanged.bind(this),u.on("chainChanged",d)),h||(h=this.onDisconnect.bind(this),u.on("disconnect",h)),e&&m!==e){let t=await this.switchChain({chainId:e}).catch(e=>{if(e.code===s.ab.code)throw e;return{id:m}});m=t?.id??m}return{accounts:t?w:w.map(e=>e.address),chainId:m}}catch(e){if(/(user closed modal|accounts received is empty|user denied account|request rejected)/i.test(e.message))throw new s.ab(e);throw e}},async disconnect(){let e=await this.getProvider();o&&(e.removeListener("accountsChanged",o),o=void 0),d&&(e.removeListener("chainChanged",d),d=void 0),h&&(e.removeListener("disconnect",h),h=void 0),e.disconnect()},async getAccounts(){let e=await this.getProvider();return(await e.request({method:"eth_accounts"})).map(e=>(0,r.K)(e))},async getChainId(){let e=await this.getProvider();return Number(await e.request({method:"eth_chainId"}))},async getProvider(){if(!t){let i="string"==typeof e.preference?{options:e.preference}:{...e.preference,options:e.preference?.options??"all"},{createBaseAccountSDK:r}=await Promise.all([n.e(846),n.e(8332),n.e(7895)]).then(n.bind(n,74324));t=r({...e,appChainIds:a.chains.map(e=>e.id),preference:i}).getProvider()}return t},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:e,chainId:t}){let n=a.chains.find(e=>e.id===t);if(!n)throw new s.x3(new i.X4);let r=await this.getProvider();try{return await r.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,c.eC)(n.id)}]}),n}catch(a){if(4902===a.code)try{let a,i;a=e?.blockExplorerUrls?e.blockExplorerUrls:n.blockExplorers?.default.url?[n.blockExplorers?.default.url]:[],i=e?.rpcUrls?.length?e.rpcUrls:[n.rpcUrls.default?.http[0]??""];let s={blockExplorerUrls:a,chainId:(0,c.eC)(t),chainName:e?.chainName??n.name,iconUrls:e?.iconUrls,nativeCurrency:e?.nativeCurrency??n.nativeCurrency,rpcUrls:i};return await r.request({method:"wallet_addEthereumChain",params:[s]}),n}catch(e){throw new s.ab(e)}throw new s.x3(a)}},onAccountsChanged(e){0===e.length?this.onDisconnect():a.emitter.emit("change",{accounts:e.map(e=>(0,r.K)(e))})},onChainChanged(e){let t=Number(e);a.emitter.emit("change",{chainId:t})},async onDisconnect(e){a.emitter.emit("disconnect");let t=await this.getProvider();o&&(t.removeListener("accountsChanged",o),o=void 0),d&&(t.removeListener("chainChanged",d),d=void 0),h&&(t.removeListener("disconnect",h),h=void 0)}}))}var d=n(14478),h=n(39504);function u(e={}){let t,i;let{shimDisconnect:c=!1}=e;return(0,a.K)(a=>({id:"safe",name:"Safe",type:u.type,async connect({withCapabilities:e}={}){let t=await this.getProvider();if(!t)throw new d.M;let n=await this.getAccounts(),r=await this.getChainId();return i||(i=this.onDisconnect.bind(this),t.on("disconnect",i)),c&&await a.storage?.removeItem("safe.disconnected"),{accounts:e?n.map(e=>({address:e,capabilities:{}})):n,chainId:r}},async disconnect(){let e=await this.getProvider();if(!e)throw new d.M;i&&(e.removeListener("disconnect",i),i=void 0),c&&await a.storage?.setItem("safe.disconnected",!0)},async getAccounts(){let e=await this.getProvider();if(!e)throw new d.M;return(await e.request({method:"eth_accounts"})).map(r.K)},async getProvider(){if("undefined"!=typeof window&&window?.parent!==window){if(!t){let{default:a}=await Promise.all([n.e(2181),n.e(4946)]).then(n.bind(n,74946)),i=new a(e),r=await (0,h.F)(()=>i.safe.getInfo(),{timeout:e.unstable_getInfoTimeout??10});if(!r)throw Error("Could not load Safe information");t=new(await (async()=>{let e=await Promise.all([n.e(2181),n.e(7353)]).then(n.t.bind(n,97353,19));return"function"!=typeof e.SafeAppProvider&&"function"==typeof e.default.SafeAppProvider?e.default.SafeAppProvider:e.SafeAppProvider})())(r,i)}return t}},async getChainId(){let e=await this.getProvider();if(!e)throw new d.M;return Number(e.chainId)},async isAuthorized(){try{if(c&&await a.storage?.getItem("safe.disconnected"))return!1;return!!(await this.getAccounts()).length}catch{return!1}},onAccountsChanged(){},onChainChanged(){},onDisconnect(){a.emitter.emit("disconnect")}}))}u.type="safe"}}]);