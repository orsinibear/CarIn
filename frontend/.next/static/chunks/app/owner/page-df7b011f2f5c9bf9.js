(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4948],{23596:function(e,t,s){Promise.resolve().then(s.bind(s,33633))},33633:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(57437),r=s(2265),l=s(45562);function n(e){let{spot:t,onEdit:s,onDelete:r,onToggleAvailability:l}=e;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-shadow",children:[(0,a.jsx)("div",{className:"w-full h-48 bg-gray-200 rounded-lg mb-4 flex items-center justify-center",children:t.images.length>0?(0,a.jsxs)("span",{className:"text-gray-500 text-sm",children:["Image: ",t.images[0]]}):(0,a.jsx)("span",{className:"text-gray-400",children:"No image"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg truncate",children:t.location}),(0,a.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:t.pricePerHour}),(0,a.jsx)("span",{className:"text-gray-500 text-sm ml-1",children:"cUSD/hr"})]}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(t.isAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t.isAvailable?"Available":"Unavailable"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-2 border-t",children:[(0,a.jsxs)("span",{children:[t.totalBookings," bookings"]}),(0,a.jsxs)("span",{className:"font-semibold",children:[t.totalEarnings," cUSD earned"]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-4 pt-4 border-t",children:[(0,a.jsx)("button",{onClick:()=>l(t.id),className:"flex-1 px-3 py-2 text-sm rounded-lg transition-colors ".concat(t.isAvailable?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"),children:t.isAvailable?"Deactivate":"Activate"}),(0,a.jsx)("button",{onClick:()=>s(t),className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>r(t.id),className:"px-3 py-2 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:"Remove"})]})]})}function i(e){let{spot:t,onClose:s,onUpdated:l}=e,[n,i]=(0,r.useState)({pricePerHour:t.pricePerHour,description:t.description,isAvailable:t.isAvailable}),[o,d]=(0,r.useState)(!1),c=async e=>{e.preventDefault(),d(!0);try{console.log("Updating spot:",t.id,n),await new Promise(e=>setTimeout(e,1e3)),alert("Spot updated successfully!"),l()}catch(e){console.error("Error updating spot:",e),alert("Failed to update spot")}finally{d(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Edit Parking Spot"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),(0,a.jsxs)("form",{onSubmit:c,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Per Hour (cUSD)"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",required:!0,value:n.pricePerHour,onChange:e=>i(t=>({...t,pricePerHour:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,a.jsx)("textarea",{rows:4,value:n.description,onChange:e=>i(t=>({...t,description:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"isAvailable",checked:n.isAvailable,onChange:e=>i(t=>({...t,isAvailable:e.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("label",{htmlFor:"isAvailable",className:"ml-2 text-sm text-gray-700",children:"Available for booking"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:o,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:o?"Saving...":"Save Changes"})]})]})]})})}function o(e){let{address:t,refreshTrigger:s}=e,[l,o]=(0,r.useState)([]),[d,c]=(0,r.useState)(!0),[x,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{g()},[t,s]);let g=async()=>{c(!0);try{o([{id:1,location:"123 Main St, San Francisco, CA",pricePerHour:"2.50",isAvailable:!0,totalBookings:45,totalEarnings:"125.50",images:["QmExample1","QmExample2"],description:"Convenient street parking near downtown"}])}catch(e){console.error("Error fetching spots:",e)}finally{c(!1)}},u=e=>{m(e)},h=async e=>{if(confirm("Are you sure you want to remove this spot?"))try{console.log("Deactivating spot:",e),await new Promise(e=>setTimeout(e,1e3)),o(t=>t.filter(t=>t.id!==e)),alert("Spot removed successfully")}catch(e){console.error("Error removing spot:",e),alert("Failed to remove spot")}},b=async e=>{try{console.log("Toggling availability for spot:",e),await new Promise(e=>setTimeout(e,1e3)),o(t=>t.map(t=>t.id===e?{...t,isAvailable:!t.isAvailable}:t))}catch(e){console.error("Error toggling availability:",e),alert("Failed to update availability")}};return d?(0,a.jsx)("div",{className:"text-center py-8",children:"Loading your spots..."}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"My Parking Spots"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Total: ",l.length," spot(s)"]})]}),0===l.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"You haven't listed any spots yet."}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"List your first spot to start earning!"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(e=>(0,a.jsx)(n,{spot:e,onEdit:u,onDelete:h,onToggleAvailability:b},e.id))}),x&&(0,a.jsx)(i,{spot:x,onClose:()=>m(null),onUpdated:()=>{m(null),g()}})]})}function d(e){let{address:t}=e,[s,l]=(0,r.useState)(null),[n,i]=(0,r.useState)(!0),[o,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c()},[t]);let c=async()=>{i(!0);try{l({totalEarnings:"342.50",pendingEarnings:"87.25",withdrawnEarnings:"255.25",transactions:[{id:"1",date:"2024-12-03T10:30:00Z",spotId:1,spotLocation:"123 Main St",amount:"12.50",status:"released",bookingId:101},{id:"2",date:"2024-12-03T08:15:00Z",spotId:1,spotLocation:"123 Main St",amount:"25.00",status:"pending",bookingId:102},{id:"3",date:"2024-12-02T15:45:00Z",spotId:1,spotLocation:"123 Main St",amount:"18.75",status:"withdrawn",bookingId:99}]})}catch(e){console.error("Error fetching earnings:",e)}finally{i(!1)}},x=async()=>{if(!s||0>=parseFloat(s.pendingEarnings)){alert("No pending earnings to withdraw");return}d(!0);try{console.log("Withdrawing earnings:",s.pendingEarnings),await new Promise(e=>setTimeout(e,2e3)),alert("Successfully withdrew ".concat(s.pendingEarnings," cUSD")),c()}catch(e){console.error("Error withdrawing earnings:",e),alert("Failed to withdraw earnings")}finally{d(!1)}};return n?(0,a.jsx)("div",{className:"text-center py-8",children:"Loading earnings data..."}):s?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Earnings Summary"}),(0,a.jsx)("button",{onClick:x,disabled:o||0>=parseFloat(s.pendingEarnings),className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:o?"Withdrawing...":"Withdraw ".concat(s.pendingEarnings," cUSD")})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,a.jsx)("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Total Earnings"}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-blue-900",children:[s.totalEarnings," ",(0,a.jsx)("span",{className:"text-lg",children:"cUSD"})]})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,a.jsx)("div",{className:"text-sm text-yellow-600 font-medium mb-1",children:"Pending"}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-yellow-900",children:[s.pendingEarnings," ",(0,a.jsx)("span",{className:"text-lg",children:"cUSD"})]})]}),(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[(0,a.jsx)("div",{className:"text-sm text-green-600 font-medium mb-1",children:"Withdrawn"}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-green-900",children:[s.withdrawnEarnings," ",(0,a.jsx)("span",{className:"text-lg",children:"cUSD"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Transaction History"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Spot"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Booking ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.transactions.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.date).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.spotLocation}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["#",e.bookingId]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[e.amount," cUSD"]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("withdrawn"===e.status?"bg-green-100 text-green-800":"released"===e.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:e.status})})]},e.id))})]})})]})]}):(0,a.jsx)("div",{className:"text-center py-8",children:"No earnings data available"})}function c(e){let{onLocationSelect:t,selectedLocation:s}=e,[l,n]=(0,r.useState)(""),[i,o]=(0,r.useState)(!1),d=async()=>{if(l.trim()){o(!0);try{t(37.7749+(Math.random()-.5)*.1,-122.4194+(Math.random()-.5)*.1,l)}catch(e){console.error("Error searching location:",e)}finally{o(!1)}}},c=()=>{d()};return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:l,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&d(),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Search address or click to pick on map"}),(0,a.jsx)("button",{type:"button",onClick:c,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"\uD83D\uDCCD Pick on Map"})]}),(0,a.jsx)("div",{className:"w-full h-64 bg-gray-200 rounded-lg flex items-center justify-center cursor-pointer hover:bg-gray-300 transition-colors",onClick:c,children:(0,a.jsx)("p",{className:"text-gray-500",children:"Click to select location on map"})})]})}function x(e){let{onImageUploaded:t}=e,[s,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),o=async e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!a)return;if(!a.type.startsWith("image/")){alert("Please select an image file");return}let r=new FileReader;r.onloadend=()=>{i(r.result)},r.readAsDataURL(a),l(!0);try{await new Promise(e=>setTimeout(e,2e3));let s="Qm".concat(Math.random().toString(36).substring(2,15)).concat(Math.random().toString(36).substring(2,15));t(s),i(null),e.target.value=""}catch(e){console.error("Error uploading to IPFS:",e),alert("Failed to upload image. Please try again.")}finally{l(!1)}};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,a.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[(0,a.jsx)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:s?(0,a.jsx)("div",{className:"text-blue-600",children:"Uploading to IPFS..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-10 h-10 mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,a.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})}),(0,a.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:o,disabled:s})]})}),n&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("img",{src:n,alt:"Preview",className:"max-w-xs rounded-lg"})})]})}function m(e){let{address:t,onSpotCreated:s}=e,[l,n]=(0,r.useState)({location:"",latitude:0,longitude:0,pricePerHour:"",description:"",images:[],availabilityStart:"00:00",availabilityEnd:"23:59",monday:!0,tuesday:!0,wednesday:!0,thursday:!0,friday:!0,saturday:!0,sunday:!0}),[i,o]=(0,r.useState)(!1),d=async e=>{e.preventDefault(),o(!0);try{console.log("Listing spot:",l),await new Promise(e=>setTimeout(e,2e3)),alert("Spot listed successfully!"),s(),n({location:"",latitude:0,longitude:0,pricePerHour:"",description:"",images:[],availabilityStart:"00:00",availabilityEnd:"23:59",monday:!0,tuesday:!0,wednesday:!0,thursday:!0,friday:!0,saturday:!0,sunday:!0})}catch(e){console.error("Error listing spot:",e),alert("Failed to list spot. Please try again.")}finally{o(!1)}};return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"List New Parking Spot"}),(0,a.jsxs)("form",{onSubmit:d,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location *"}),(0,a.jsx)(c,{onLocationSelect:(e,t,s)=>{n(a=>({...a,latitude:e,longitude:t,location:s}))},selectedLocation:l.location}),l.location&&(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:[l.location," (",l.latitude.toFixed(6),", ",l.longitude.toFixed(6),")"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Per Hour (cUSD) *"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",required:!0,value:l.pricePerHour,onChange:e=>n(t=>({...t,pricePerHour:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 2.50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Availability Schedule"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Start Time"}),(0,a.jsx)("input",{type:"time",value:l.availabilityStart,onChange:e=>n(t=>({...t,availabilityStart:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"End Time"}),(0,a.jsx)("input",{type:"time",value:l.availabilityEnd,onChange:e=>n(t=>({...t,availabilityEnd:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-2",children:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:l[e],onChange:t=>n(s=>({...s,[e]:t.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"text-xs text-gray-700 capitalize",children:e.slice(0,3)})]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spot Images (IPFS)"}),(0,a.jsx)(x,{onImageUploaded:e=>{n(t=>({...t,images:[...t.images,e]}))}}),l.images.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Uploaded ",l.images.length," image(s)"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:l.images.map((e,t)=>(0,a.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs",children:[e.slice(0,10),"..."]},t))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,a.jsx)("textarea",{rows:4,value:l.description,onChange:e=>n(t=>({...t,description:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe your parking spot, nearby landmarks, accessibility, etc."})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{type:"submit",disabled:i||!l.location||!l.pricePerHour,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:i?"Listing Spot...":"List Spot"})})]})]})}function g(e){let{address:t}=e,[s,l]=(0,r.useState)(null),[n,i]=(0,r.useState)(!0);(0,r.useEffect)(()=>{o()},[t]);let o=async()=>{i(!0);try{l({totalSpots:3,activeSpots:2,totalBookings:127,totalRevenue:"342.50",averageBookingDuration:"2.5 hours",bookingsByDay:[{day:"Mon",count:18},{day:"Tue",count:22},{day:"Wed",count:20},{day:"Thu",count:25},{day:"Fri",count:28},{day:"Sat",count:14},{day:"Sun",count:10}],revenueByMonth:[{month:"Oct",amount:"89.50"},{month:"Nov",amount:"165.25"},{month:"Dec",amount:"87.75"}]})}catch(e){console.error("Error fetching statistics:",e)}finally{i(!1)}};if(n)return(0,a.jsx)("div",{className:"text-center py-8",children:"Loading statistics..."});if(!s)return(0,a.jsx)("div",{className:"text-center py-8",children:"No statistics available"});let d=Math.max(...s.bookingsByDay.map(e=>e.count)),c=Math.max(...s.revenueByMonth.map(e=>parseFloat(e.amount)));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Booking Statistics & Analytics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Spots"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:s.totalSpots})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Active Spots"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:s.activeSpots})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Bookings"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:s.totalBookings})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Revenue"}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[s.totalRevenue," cUSD"]})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Bookings by Day of Week"}),(0,a.jsx)("div",{className:"flex items-end justify-between h-64 gap-2",children:s.bookingsByDay.map(e=>(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"relative w-full h-full flex items-end",children:(0,a.jsx)("div",{className:"w-full bg-blue-500 rounded-t transition-all hover:bg-blue-600",style:{height:"".concat(e.count/d*100,"%"),minHeight:e.count>0?"4px":"0"},title:"".concat(e.count," bookings")})}),(0,a.jsx)("div",{className:"mt-2 text-xs text-gray-600",children:e.day}),(0,a.jsx)("div",{className:"text-xs font-medium",children:e.count})]},e.day))})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Revenue by Month"}),(0,a.jsx)("div",{className:"flex items-end justify-between h-64 gap-4",children:s.revenueByMonth.map(e=>(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"relative w-full h-full flex items-end",children:(0,a.jsx)("div",{className:"w-full bg-green-500 rounded-t transition-all hover:bg-green-600",style:{height:"".concat(parseFloat(e.amount)/c*100,"%"),minHeight:parseFloat(e.amount)>0?"4px":"0"},title:"".concat(e.amount," cUSD")})}),(0,a.jsx)("div",{className:"mt-2 text-xs text-gray-600",children:e.month}),(0,a.jsxs)("div",{className:"text-xs font-medium",children:[e.amount," cUSD"]})]},e.month))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Average Booking Duration"}),(0,a.jsx)("div",{className:"text-3xl font-bold text-purple-600",children:s.averageBookingDuration})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Booking Rate"}),(0,a.jsx)("div",{className:"text-3xl font-bold text-orange-600",children:(s.totalBookings/s.totalSpots).toFixed(1)}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"bookings per spot"})]})]})]})}var u=s(791),h=s(41960);function b(e){let{onScanSuccess:t,onScanError:s,expectedSigner:l}=e,[n,i]=(0,r.useState)(null),[o,d]=(0,r.useState)("idle"),[c,x]=(0,r.useState)(null),m=(0,r.useRef)(null);(0,r.useEffect)(()=>{m.current&&m.current.clear().catch(console.error);let e=new u.wF("qr-reader-container",{fps:10,qrbox:{width:250,height:250},aspectRatio:1},!1);return m.current=e,e.render(async a=>{try{e.pause(!0)}catch(e){console.warn("Failed to pause scanner",e)}i(a),d("validating");let r=(0,h.hV)(a);if(!r){d("invalid"),x("Invalid QR Code format"),s&&s("Invalid QR Code format");return}let n=await (0,h.yR)(r,l);n.valid?(d("valid"),t(r)):(d("invalid"),x(n.error||"Validation failed"),s&&s(n.error||"Validation failed"))},e=>{}),()=>{m.current&&m.current.clear().catch(console.error)}},[t,s,l]);let g=()=>{i(null),d("idle"),x(null),m.current&&m.current.resume()};return(0,a.jsxs)("div",{className:"w-full max-w-md mx-auto p-4 bg-white rounded-lg shadow",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-center",children:"Scan Booking QR Code"}),(0,a.jsx)("div",{id:"qr-reader-container",className:"w-full overflow-hidden rounded-lg"}),"validating"===o&&(0,a.jsxs)("div",{className:"text-center py-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-blue-600",children:"Verifying..."})]}),"valid"===o&&(0,a.jsxs)("div",{className:"text-center py-4 bg-green-50 rounded-lg mt-4 border border-green-200",children:[(0,a.jsxs)("div",{className:"text-green-600 text-xl font-bold mb-2 flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Access Granted"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Valid Booking Found"}),(0,a.jsx)("button",{onClick:g,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Scan Another"})]}),"invalid"===o&&(0,a.jsxs)("div",{className:"text-center py-4 bg-red-50 rounded-lg mt-4 border border-red-200",children:[(0,a.jsxs)("div",{className:"text-red-600 text-xl font-bold mb-2 flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Access Denied"]}),(0,a.jsx)("p",{className:"text-sm text-red-500 font-medium",children:c}),(0,a.jsx)("button",{onClick:g,className:"mt-4 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:"Try Again"})]})]})}function p(e){let{address:t}=e,[s,l]=(0,r.useState)("spots"),[n,i]=(0,r.useState)(0),[c,x]=(0,r.useState)(null);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"Owner Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage your parking spots, view earnings, and track bookings"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Connected: ",t.slice(0,6),"...",t.slice(-4)]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 overflow-x-auto",children:(0,a.jsxs)("nav",{className:"flex -mb-px",children:[(0,a.jsx)("button",{onClick:()=>l("spots"),className:"px-6 py-4 text-sm font-medium whitespace-nowrap ".concat("spots"===s?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"My Spots"}),(0,a.jsx)("button",{onClick:()=>l("list"),className:"px-6 py-4 text-sm font-medium whitespace-nowrap ".concat("list"===s?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"List New Spot"}),(0,a.jsx)("button",{onClick:()=>l("earnings"),className:"px-6 py-4 text-sm font-medium whitespace-nowrap ".concat("earnings"===s?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Earnings"}),(0,a.jsx)("button",{onClick:()=>l("statistics"),className:"px-6 py-4 text-sm font-medium whitespace-nowrap ".concat("statistics"===s?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Statistics"}),(0,a.jsx)("button",{onClick:()=>l("scan"),className:"px-6 py-4 text-sm font-medium whitespace-nowrap ".concat("scan"===s?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Scan QR"})]})}),(0,a.jsxs)("div",{className:"p-6",children:["spots"===s&&(0,a.jsx)(o,{address:t,refreshTrigger:n}),"list"===s&&(0,a.jsx)(m,{address:t,onSpotCreated:()=>{i(e=>e+1),l("spots")}}),"earnings"===s&&(0,a.jsx)(d,{address:t}),"statistics"===s&&(0,a.jsx)(g,{address:t}),"scan"===s&&(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Verify Booking Access"}),(0,a.jsx)("div",{className:"w-full max-w-lg mb-6",children:(0,a.jsx)(b,{onScanSuccess:e=>{console.log("Scanned:",e),x({valid:!0,message:"Valid Booking Found!",data:e})},onScanError:e=>{e&&!e.includes("No QR code found")&&x({valid:!1,message:e})}})}),c&&(0,a.jsxs)("div",{className:"p-4 rounded-lg border ".concat(c.valid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"," w-full max-w-lg"),children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat(c.valid?"bg-green-500":"bg-red-500")}),(0,a.jsx)("h3",{className:"font-bold ".concat(c.valid?"text-green-800":"text-red-800"),children:c.valid?"Access Granted":"Access Denied"})]}),(0,a.jsx)("p",{className:"text-sm ".concat(c.valid?"text-green-700":"text-red-700"),children:c.message}),c.valid&&c.data&&(0,a.jsxs)("div",{className:"mt-3 text-sm text-green-800 border-t border-green-200 pt-2",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Booking ID:"})," ",c.data.bookingId]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Spot ID:"})," ",c.data.spotId]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Time:"})," ",new Date(c.data.timestamp).toLocaleString()]})]}),(0,a.jsx)("button",{onClick:()=>x(null),className:"mt-4 text-sm underline text-gray-600 hover:text-gray-900",children:"Scan Another"})]})]})]})]})]})}function y(){let[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(null);return e?(0,a.jsx)("main",{className:"min-h-screen p-8 bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsx)(p,{address:s})})}):(0,a.jsx)("main",{className:"min-h-screen p-8 bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Owner Dashboard"}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,a.jsx)("p",{className:"text-lg text-gray-600 mb-6",children:"Please connect your wallet to access the owner dashboard"}),(0,a.jsx)(l.Z,{onConnect:e=>{n(e),t(!0)}})]})]})})}},45562:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(57437);function r(e){let{onConnect:t}=e,s=async()=>{t("0x1234567890123456789012345678901234567890")};return(0,a.jsx)("button",{onClick:s,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Connect Wallet"})}},41960:function(e,t,s){"use strict";s.d(t,{CS:function(){return r},hV:function(){return l},yR:function(){return n}});var a=s(48790);function r(e,t,s,a,r,l){return JSON.stringify({bookingId:e,spotId:t,location:s,timestamp:l||Date.now(),type:"parking_access",signature:a,signerAddress:r})}function l(e){try{let t=JSON.parse(e);if(!t.bookingId||!t.spotId||!t.type)return null;return t}catch(e){return null}}async function n(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:48;if(Date.now()-e.timestamp>36e5*s)return{valid:!1,error:"QR code expired"};if(e.signature&&t){var r,l;if(!e.signerAddress||e.signerAddress.toLowerCase()!==t.toLowerCase())return{valid:!1,error:"Signer address mismatch"};let s=(r=e.bookingId,l=e.timestamp,"Access Request for Booking: ".concat(r,"\nTimestamp: ").concat(l));try{if(!await (0,a.n)({address:t,message:s,signature:e.signature}))return{valid:!1,error:"Invalid signature"}}catch(e){return{valid:!1,error:"Signature verification failed"}}}else if(t)return{valid:!1,error:"Missing signature"};return{valid:!0}}}},function(e){e.O(0,[52,9696,7656,2971,2117,1744],function(){return e(e.s=23596)}),_N_E=e.O()}]);