(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4195],{88109:function(e,r,t){Promise.resolve().then(t.bind(t,56767))},56767:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return o}});var a=t(57437),n=t(82070),s=t(64856),i=t(21843),l=t(45562);function o(){let{address:e,isConnected:r}=(0,i.R)(),{balance:t,loading:o,error:d,claimReward:c,claimAllRewards:u}=(0,n.tb)();if(!r)return(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Rewards Dashboard"}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Please connect your wallet to view your rewards"}),(0,a.jsx)(l.Z,{})]})]})});let m=async e=>{try{await c(e),alert("Reward claimed successfully!")}catch(e){alert("Failed to claim reward: ".concat(e instanceof Error?e.message:"Unknown error"))}},p=async()=>{try{await u(),alert("All rewards claimed successfully!")}catch(e){alert("Failed to claim rewards: ".concat(e instanceof Error?e.message:"Unknown error"))}};return(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Rewards Dashboard"}),d&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:d}),o?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading rewards..."})]}):t?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Your Rewards Balance"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Balance"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-blue-600",children:[t.balance," CARIN"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Pending Rewards"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-green-600",children:[t.pendingTotal," CARIN"]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Pending Rewards Breakdown"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"border rounded p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Inaccuracy Reports"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[t.pendingByType.inaccuracyReport," CARIN"]}),parseFloat(t.pendingByType.inaccuracyReport)>0&&(0,a.jsx)("button",{onClick:()=>m(s.E4.InaccuracyReport),className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Claim"})]}),(0,a.jsxs)("div",{className:"border rounded p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Spot Shares"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[t.pendingByType.spotShare," CARIN"]}),parseFloat(t.pendingByType.spotShare)>0&&(0,a.jsx)("button",{onClick:()=>m(s.E4.SpotShare),className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Claim"})]}),(0,a.jsxs)("div",{className:"border rounded p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Referrals"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[t.pendingByType.referral," CARIN"]}),parseFloat(t.pendingByType.referral)>0&&(0,a.jsx)("button",{onClick:()=>m(s.E4.Referral),className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Claim"})]}),(0,a.jsxs)("div",{className:"border rounded p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Community Contributions"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[t.pendingByType.communityContribution," CARIN"]}),parseFloat(t.pendingByType.communityContribution)>0&&(0,a.jsx)("button",{onClick:()=>m(s.E4.CommunityContribution),className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Claim"})]})]})]}),parseFloat(t.pendingTotal)>0&&(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("button",{onClick:p,className:"w-full px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-semibold",children:["Claim All Pending Rewards (",t.pendingTotal," CARIN)"]})})]}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:(0,a.jsx)("p",{className:"text-gray-600",children:"No rewards data available"})})]})})}},45562:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var a=t(57437);function n(e){let{onConnect:r}=e,t=async()=>{r("0x1234567890123456789012345678901234567890")};return(0,a.jsx)("button",{onClick:t,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Connect Wallet"})}},64856:function(e,r,t){"use strict";t.d(r,{E4:function(){return n},FM:function(){return d}});var a,n,s=t(12809),i=t(40257);let l=["function submitInaccuracyReport(uint256 spotId, string memory reason, bytes memory evidenceHash) external","function createReferral(address referee, uint256 spotId) external","function claimReward(uint8 rewardType) external","function claimAllRewards() external","function getPendingRewards(address user) external view returns (uint256)","function getPendingRewardByType(address user, uint8 rewardType) external view returns (uint256)","function reports(uint256 reportId) external view returns (tuple(uint256 reportId, uint256 spotId, address reporter, string reason, bytes evidenceHash, uint256 timestamp, bool isValid, uint8 claimStatus, uint256 rewardAmount))","function referrals(bytes32 referralHash) external view returns (tuple(address referrer, address referee, uint256 spotId, uint256 timestamp, bool isActive, uint256 rewardAmount, uint8 claimStatus))","function userReports(address user) external view returns (uint256[] memory)","function userReferrals(address user) external view returns (bytes32[] memory)","function inaccuracyReportReward() external view returns (uint256)","function spotShareReward() external view returns (uint256)","function referralReward() external view returns (uint256)","event ReportSubmitted(uint256 indexed reportId, uint256 indexed spotId, address indexed reporter, string reason)","event ReferralCreated(bytes32 indexed referralHash, address indexed referrer, address indexed referee, uint256 spotId)","event RewardClaimed(address indexed user, uint8 rewardType, uint256 amount, uint256 timestamp)"];(a=n||(n={}))[a.InaccuracyReport=0]="InaccuracyReport",a[a.SpotShare=1]="SpotShare",a[a.Referral=2]="Referral",a[a.CommunityContribution=3]="CommunityContribution";let o={alfajores:i.env.NEXT_PUBLIC_REWARDS_MANAGER_ADDRESS_ALFAJORES||"",celo:i.env.NEXT_PUBLIC_REWARDS_MANAGER_ADDRESS_CELO||""};function d(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"alfajores",t=o[r];if(!t)throw Error("RewardsManager address not configured for ".concat(r));return new s.CH(t,l,e)}},82070:function(e,r,t){"use strict";t.d(r,{Hs:function(){return m},MB:function(){return p},tb:function(){return u}});var a=t(2265),n=t(21843),s=t(53882),i=t(13577),l=t(41662),o=t(9478),d=t(64856),c=t(40257);function u(){let{address:e,isConnected:r}=(0,n.R)(),t=(0,s.t)(),{data:o}=(0,i.p)(),[u,m]=(0,a.useState)(null),[p,x]=(0,a.useState)(!1),[w,f]=(0,a.useState)(null),h=(0,a.useCallback)(async()=>{if(!e||!t||!r){m(null);return}try{x(!0),f(null);let r="alfajores",a=c.env.NEXT_PUBLIC_REWARDS_TOKEN_ADDRESS_ALFAJORES,n=c.env.NEXT_PUBLIC_REWARDS_MANAGER_ADDRESS_ALFAJORES;if(!a||!n)throw Error("Rewards contracts not configured");let s=(0,d.getRewardsTokenContract)(t,r),i=await s.balanceOf(e),o=(0,d.FM)(t,r),u=await o.getPendingRewards(e),p=await o.getPendingRewardByType(e,d.E4.InaccuracyReport),w=await o.getPendingRewardByType(e,d.E4.SpotShare),h=await o.getPendingRewardByType(e,d.E4.Referral),b=await o.getPendingRewardByType(e,d.E4.CommunityContribution);m({balance:l.dF(i),pendingTotal:l.dF(u),pendingByType:{inaccuracyReport:l.dF(p),spotShare:l.dF(w),referral:l.dF(h),communityContribution:l.dF(b)}})}catch(e){console.error("Error loading rewards balance:",e),f(e instanceof Error?e.message:"Failed to load rewards")}finally{x(!1)}},[e,t,r]);(0,a.useEffect)(()=>{h()},[h]);let b=(0,a.useCallback)(async r=>{if(!o||!e)throw Error("Wallet not connected");try{x(!0),f(null);let e=(0,d.FM)(o,"alfajores"),t=await e.claimReward(r);await t.wait(),await h()}catch(e){throw console.error("Error claiming reward:",e),f(e instanceof Error?e.message:"Failed to claim reward"),e}finally{x(!1)}},[o,e,h]),y=(0,a.useCallback)(async()=>{if(!o||!e)throw Error("Wallet not connected");try{x(!0),f(null);let e=(0,d.FM)(o,"alfajores"),r=await e.claimAllRewards();await r.wait(),await h()}catch(e){throw console.error("Error claiming all rewards:",e),f(e instanceof Error?e.message:"Failed to claim rewards"),e}finally{x(!1)}},[o,e,h]);return{balance:u,loading:p,error:w,loadBalance:h,claimReward:b,claimAllRewards:y}}function m(){let{address:e,isConnected:r}=(0,n.R)(),t=(0,s.t)(),{data:c}=(0,i.p)(),[u,m]=(0,a.useState)([]),[p,x]=(0,a.useState)(!1),w=(0,a.useCallback)(async()=>{if(!e||!t||!r){m([]);return}try{x(!0);let r=(0,d.FM)(t,"alfajores"),a=await r.userReports(e),n=await Promise.all(a.map(e=>r.reports(e)));m(n.map((e,r)=>({reportId:Number(a[r]),spotId:Number(e.spotId),reason:e.reason,timestamp:Number(e.timestamp),isValid:e.isValid,claimStatus:Number(e.claimStatus),rewardAmount:l.dF(e.rewardAmount)})))}catch(e){console.error("Error loading reports:",e)}finally{x(!1)}},[e,t,r]);return(0,a.useEffect)(()=>{w()},[w]),{reports:u,loading:p,submitReport:(0,a.useCallback)(async(r,t,a)=>{if(!c||!e)throw Error("Wallet not connected");try{x(!0);let e=(0,d.FM)(c,"alfajores"),n=o.Y0(a),s=await e.submitInaccuracyReport(r,t,n);await s.wait(),await w()}catch(e){throw console.error("Error submitting report:",e),e}finally{x(!1)}},[c,e,w]),loadReports:w}}function p(){let{address:e,isConnected:r}=(0,n.R)(),t=(0,s.t)(),{data:o}=(0,i.p)(),[c,u]=(0,a.useState)([]),[m,p]=(0,a.useState)(!1),x=(0,a.useCallback)(async()=>{if(!e||!t||!r){u([]);return}try{p(!0);let r=(0,d.FM)(t,"alfajores"),a=await r.userReferrals(e),n=await Promise.all(a.map(e=>r.referrals(e)));u(n.map((e,r)=>({referralHash:a[r],referee:e.referee,spotId:Number(e.spotId),timestamp:Number(e.timestamp),isActive:e.isActive,rewardAmount:l.dF(e.rewardAmount),claimStatus:Number(e.claimStatus)})))}catch(e){console.error("Error loading referrals:",e)}finally{p(!1)}},[e,t,r]);return(0,a.useEffect)(()=>{x()},[x]),{referrals:c,loading:m,createReferral:(0,a.useCallback)(async(r,t)=>{if(!o||!e)throw Error("Wallet not connected");try{p(!0);let e=(0,d.FM)(o,"alfajores"),a=await e.createReferral(r,t);await a.wait(),await x()}catch(e){throw console.error("Error creating referral:",e),e}finally{p(!1)}},[o,e,x]),loadReferrals:x}}}},function(e){e.O(0,[9696,58,642,846,8332,9334,7077,6130,2971,2117,1744],function(){return e(e.s=88109)}),_N_E=e.O()}]);