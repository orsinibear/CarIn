(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{98727:function(e,t,s){Promise.resolve().then(s.bind(s,73032))},73032:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var n=s(57437),a=s(2265),r=s(30166);function i(e){let{currentView:t,onViewChange:s}=e;return(0,n.jsxs)("div",{className:"flex bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200",children:[(0,n.jsxs)("button",{onClick:()=>s("map"),className:"px-4 py-2 flex items-center gap-2 transition-colors ".concat("map"===t?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:[(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),(0,n.jsx)("span",{className:"font-medium",children:"Map"})]}),(0,n.jsxs)("button",{onClick:()=>s("list"),className:"px-4 py-2 flex items-center gap-2 transition-colors border-l border-gray-200 ".concat("list"===t?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:[(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),(0,n.jsx)("span",{className:"font-medium",children:"List"})]})]})}var l=s(27648),o=s(43781);function c(e){let{spots:t,userLocation:s,onSpotClick:a}=e,r=[...t].sort((e,t)=>s&&e.coordinates&&t.coordinates?(0,o.cL)(s,e.coordinates)-(0,o.cL)(s,t.coordinates):0);return 0===t.length?(0,n.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,n.jsx)("p",{className:"text-gray-600",children:"No parking spots found"}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Try adjusting your filters"})]}):(0,n.jsx)("div",{className:"space-y-4",children:r.map(e=>{let t=s&&e.coordinates?(0,o.Bb)((0,o.cL)(s,e.coordinates)):null;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow cursor-pointer border border-gray-200",onClick:()=>null==a?void 0:a(e),children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,n.jsx)("div",{className:"w-full md:w-32 h-32 bg-gray-200 rounded-lg flex-shrink-0 flex items-center justify-center",children:e.images&&e.images.length>0?(0,n.jsx)("span",{className:"text-gray-500 text-xs",children:"Image available"}):(0,n.jsx)("span",{className:"text-gray-400 text-xs",children:"No image"})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,n.jsxs)("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:["Spot #",e.id]}),(0,n.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ".concat(e.isAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isAvailable?"Available":"Unavailable"})]}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-2 truncate",children:e.location}),e.description&&(0,n.jsx)("p",{className:"text-sm text-gray-700 mb-3 line-clamp-2",children:e.description}),(0,n.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-xl font-bold text-blue-600",children:e.pricePerHour}),(0,n.jsx)("span",{className:"text-gray-500 text-sm ml-1",children:"cUSD/hr"})]}),t&&(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,n.jsxs)("svg",{className:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t," away"]})]}),(0,n.jsx)(l.default,{href:"/booking/".concat(e.id),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm font-medium",onClick:e=>e.stopPropagation(),children:"View Details"})]})]})]})},e.id)})})}var d=s(97130),x=s(96567);let u=(0,r.default)(()=>Promise.all([s.e(4212),s.e(319)]).then(s.bind(s,60319)),{loadableGenerated:{webpack:()=>[60319]},ssr:!1,loading:()=>(0,n.jsx)("div",{className:"w-full h-[600px] flex items-center justify-center bg-gray-100",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading map..."})]})})});function m(){let[e,t]=(0,a.useState)("map"),{spots:s,loading:r}=(0,d.j)(),{location:l}=(0,x.Z)(),o=e=>{window.location.href="/booking/".concat(e.id)};return(0,n.jsxs)("main",{className:"min-h-screen",children:[(0,n.jsx)("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"CarIn"}),(0,n.jsx)("p",{className:"text-gray-600 mt-1",children:"Decentralized parking spot booking on Celo blockchain"})]}),(0,n.jsx)(i,{currentView:e,onViewChange:t})]})})}),(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:"map"===e?(0,n.jsx)("div",{className:"h-[calc(100vh-200px)] min-h-[600px]",children:(0,n.jsx)(u,{onSpotClick:o})}):(0,n.jsx)("div",{children:r?(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading parking spots..."})]}):(0,n.jsx)(c,{spots:s,userLocation:l,onSpotClick:o})})})]})}},96567:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var n=s(2265);function a(){let[e,t]=(0,n.useState)({location:null,loading:!1,error:null,permissionDenied:!1}),s=(0,n.useCallback)(()=>{if(!navigator.geolocation){t({location:null,loading:!1,error:{code:0,message:"Geolocation is not supported by this browser"},permissionDenied:!1});return}t(e=>({...e,loading:!0,error:null})),navigator.geolocation.getCurrentPosition(e=>{t({location:{lat:e.coords.latitude,lng:e.coords.longitude},loading:!1,error:null,permissionDenied:!1})},e=>{t({location:null,loading:!1,error:{code:e.code,message:e.message},permissionDenied:1===e.code})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},[]);return(0,n.useEffect)(()=>{},[s]),{...e,getCurrentPosition:s}}},97130:function(e,t,s){"use strict";s.d(t,{j:function(){return a}});var n=s(2265);function a(){let[e,t]=(0,n.useState)({spots:[],loading:!1,error:null,lastFetch:null}),s=(0,n.useCallback)(async()=>{t(e=>({...e,loading:!0,error:null}));try{await new Promise(e=>setTimeout(e,500)),t({spots:[{id:1,location:"123 Main St, San Francisco, CA",coordinates:{lat:37.7749,lng:-122.4194},pricePerHour:"2.50",isAvailable:!0,owner:"0x123...",images:[],description:"Convenient street parking near downtown"},{id:2,location:"456 Market St, San Francisco, CA",coordinates:{lat:37.7849,lng:-122.4094},pricePerHour:"3.00",isAvailable:!0,owner:"0x456...",images:[],description:"Premium parking spot in financial district"},{id:3,location:"789 Mission St, San Francisco, CA",coordinates:{lat:37.7649,lng:-122.4294},pricePerHour:"1.75",isAvailable:!1,owner:"0x789...",images:[],description:"Affordable parking option"}],loading:!1,error:null,lastFetch:Date.now()})}catch(e){t(t=>({...t,loading:!1,error:e.message||"Failed to fetch parking spots"}))}},[]),a=(0,n.useCallback)(()=>{s()},[s]);(0,n.useEffect)(()=>{s()},[s]);let r=(0,n.useCallback)(()=>!e.lastFetch||Date.now()-e.lastFetch>3e4,[e.lastFetch]);return(0,n.useEffect)(()=>{if(r()&&!e.loading){let e=setInterval(()=>{r()&&s()},3e4);return()=>clearInterval(e)}},[r,e.loading,s]),{spots:e.spots,loading:e.loading,error:e.error,refresh:a}}},43781:function(e,t,s){"use strict";function n(e,t){let s=a(t.lat-e.lat),n=a(t.lng-e.lng),r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(a(e.lat))*Math.cos(a(t.lat))*Math.sin(n/2)*Math.sin(n/2);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*6371}function a(e){return e*Math.PI/180}function r(e){return e<1?"".concat(Math.round(1e3*e),"m"):"".concat(e.toFixed(1),"km")}s.d(t,{Bb:function(){return r},cL:function(){return n}})}},function(e){e.O(0,[1288,2971,2117,1744],function(){return e(e.s=98727)}),_N_E=e.O()}]);