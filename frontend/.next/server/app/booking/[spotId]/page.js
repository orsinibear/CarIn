(()=>{var e={};e.id=8568,e.ids=[8568],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},85807:e=>{"use strict";e.exports=require("module")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},6005:e=>{"use strict";e.exports=require("node:crypto")},65714:e=>{"use strict";e.exports=require("node:diagnostics_channel")},15673:e=>{"use strict";e.exports=require("node:events")},70612:e=>{"use strict";e.exports=require("node:os")},49411:e=>{"use strict";e.exports=require("node:path")},6610:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d}),t(46636),t(54579),t(35866);var r=t(23191),a=t(88716),n=t(37922),i=t.n(n),l=t(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let d=["",{children:["booking",{children:["[spotId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,46636)),"C:\\Users\\MSI\\Desktop\\walletconnect\\CarIn\\frontend\\app\\booking\\[spotId]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,54579)),"C:\\Users\\MSI\\Desktop\\walletconnect\\CarIn\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\MSI\\Desktop\\walletconnect\\CarIn\\frontend\\app\\booking\\[spotId]\\page.tsx"],x="/booking/[spotId]/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/booking/[spotId]/page",pathname:"/booking/[spotId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},99767:(e,s,t)=>{Promise.resolve().then(t.bind(t,85900))},19712:(e,s,t)=>{Promise.resolve().then(t.bind(t,52957))},83722:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},85900:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var r=t(10326),a=t(17577),n=t(77389),i=t(9428);function l({spot:e,onSelect:s}){let[t,n]=(0,a.useState)(null),[i,l]=(0,a.useState)("09:00"),[o,d]=(0,a.useState)("17:00"),c=()=>{if(!i||!o)return 0;let e=parseInt(i.split(":")[0]),s=parseInt(o.split(":")[0]);return(s>e?s-e:24-e+s)||1};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date *"}),r.jsx("div",{className:"border border-gray-300 rounded-lg p-4",children:r.jsx("input",{type:"date",min:new Date().toISOString().split("T")[0],value:t?t.toISOString().split("T")[0]:"",onChange:e=>n(e.target.value?new Date(e.target.value):null),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time *"}),r.jsx("input",{type:"time",value:i,onChange:e=>l(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Time *"}),r.jsx("input",{type:"time",value:o,onChange:e=>d(e.target.value),min:i,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),t&&i&&o&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Duration"}),(0,r.jsxs)("p",{className:"text-lg font-semibold",children:[c()," hour(s)"]})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Estimated Cost"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-blue-600",children:[(()=>{let s=c();return(parseFloat(e.pricePerHour)*s).toFixed(2)})()," cUSD"]})]})]})}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{onClick:()=>{if(!t){alert("Please select a date");return}s(t,i,o)},disabled:!t||!i||!o,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Continue to Summary"})})]})}function o({spot:e,selectedDate:s,startTime:t,endTime:n,onBack:i,onConfirm:l,userAddress:o}){let{createBooking:d,loading:c,error:x}=function(){let[e,s]=(0,a.useState)(!1),[t,r]=(0,a.useState)(null);return{createBooking:(0,a.useCallback)(async(e,t)=>{s(!0),r(null);try{await new Promise(e=>setTimeout(e,2e3));let e=`booking_${Date.now()}`,s=`0x${Math.random().toString(16).substring(2,66)}`;return{success:!0,bookingId:e,transactionHash:s}}catch(s){let e=s.message||"Failed to create booking";return r(e),{success:!1,error:e}}finally{s(!1)}},[]),loading:e,error:t}}(),[u,m]=(0,a.useState)(!1),p=(()=>{let e=parseInt(t.split(":")[0]),s=parseInt(n.split(":")[0]);return s>e?s-e:24-e+s||1})(),g=parseFloat(e.pricePerHour)*p,h=.05*g,b=g+h,j=async()=>{m(!0);try{let r={spotId:e.id,date:s.toISOString(),startTime:t,endTime:n,hours:p,totalCost:b.toString()};(await d(r,o)).success&&l()}catch(e){console.error("Booking error:",e)}finally{m(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h3",{className:"text-xl font-semibold",children:"Booking Summary"}),r.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Location:"}),r.jsx("span",{className:"font-medium",children:e.location})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Date:"}),r.jsx("span",{className:"font-medium",children:s.toLocaleDateString()})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Time:"}),(0,r.jsxs)("span",{className:"font-medium",children:[t," - ",n]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Duration:"}),(0,r.jsxs)("span",{className:"font-medium",children:[p," hour(s)"]})]})]})}),(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[r.jsx("h4",{className:"font-semibold mb-3",children:"Cost Breakdown"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-gray-700",children:[(0,r.jsxs)("span",{children:["Subtotal (",p," hrs \xd7 ",e.pricePerHour," cUSD/hr):"]}),(0,r.jsxs)("span",{children:[g.toFixed(2)," cUSD"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-gray-700",children:[r.jsx("span",{children:"Service Fee (5%):"}),(0,r.jsxs)("span",{children:[h.toFixed(2)," cUSD"]})]}),(0,r.jsxs)("div",{className:"border-t pt-2 mt-2 flex justify-between text-lg font-bold",children:[r.jsx("span",{children:"Total:"}),(0,r.jsxs)("span",{className:"text-blue-600",children:[b.toFixed(2)," cUSD"]})]})]})]}),x&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:x}),(0,r.jsxs)("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:i,disabled:u||c,className:"flex-1 px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Back"}),r.jsx("button",{onClick:j,disabled:u||c,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:u||c?"Processing...":"Confirm Booking"})]})]})}t(82094);var d=t(81917);function c({bookingId:e,spot:s,signature:t,userAddress:a}){return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Booking Confirmed!"}),r.jsx("p",{className:"text-gray-600",children:"Your parking spot has been successfully booked"})]}),r.jsx("div",{className:"mb-6",children:r.jsx(d.Z,{bookingId:e,spotId:s.id,spotLocation:s.location,signature:t,signerAddress:a})}),(0,r.jsxs)("div",{className:"border-t pt-6 space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Booking ID:"}),r.jsx("span",{className:"font-medium break-all text-right ml-4",children:e})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Spot Location:"}),r.jsx("span",{className:"font-medium text-right ml-4",children:s.location})]}),a&&(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Booked By:"}),r.jsx("span",{className:"font-medium text-right ml-4 break-all text-xs",children:a})]})]}),(0,r.jsxs)("div",{className:"mt-8 flex flex-col sm:flex-row gap-4 justify-center",children:[r.jsx("button",{onClick:()=>window.location.href="/bookings",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"View Booking History"}),r.jsx("button",{onClick:()=>window.print(),className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Save Receipt"})]})]})}function x({spot:e,userAddress:s}){let[t,n]=(0,a.useState)("select-time"),[i,d]=(0,a.useState)(null),[x,u]=(0,a.useState)(""),[m,p]=(0,a.useState)(""),[g,h]=(0,a.useState)(null),[b,j]=(0,a.useState)(null),[f,y]=(0,a.useState)(null),v=async()=>{if(!i||!x||!m){y("Please select date and time");return}n("confirming"),y(null);try{await new Promise(e=>setTimeout(e,2e3));let e=`booking_${Date.now()}`,s="0x"+Array.from({length:64},()=>Math.floor(16*Math.random()).toString(16)).join("");h(e),j(s),n("confirmed")}catch(e){y(e.message||"Failed to create booking"),n("summary")}};return"confirmed"===t&&g?r.jsx(c,{bookingId:g,spot:e,signature:b||void 0,userAddress:s}):(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[r.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Book Parking Spot"}),f&&r.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:f}),"select-time"===t&&r.jsx(l,{spot:e,onSelect:(e,s,t)=>{d(e),u(s),p(t),n("summary")}}),"summary"===t&&i&&r.jsx(o,{spot:e,selectedDate:i,startTime:x,endTime:m,onBack:()=>{n("select-time"),y(null)},onConfirm:v,userAddress:s}),"confirming"===t&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-lg text-gray-600",children:"Processing your booking..."}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please confirm the transaction in your wallet"})]})]})}function u({spot:e}){return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden mb-6",children:[r.jsx("div",{className:"w-full h-64 bg-gray-200 flex items-center justify-center",children:e.images&&e.images.length>0?(0,r.jsxs)("span",{className:"text-gray-500",children:["Image: ",e.images[0]]}):r.jsx("span",{className:"text-gray-400",children:"No image available"})}),(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("h1",{className:"text-3xl font-bold mb-4",children:e.location}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-4xl font-bold text-blue-600",children:e.pricePerHour}),r.jsx("span",{className:"text-gray-500 ml-2",children:"cUSD/hour"})]}),r.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-medium ${e.isAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.isAvailable?"Available":"Unavailable"})]}),r.jsx("p",{className:"text-gray-700 mb-4",children:e.description}),(0,r.jsxs)("div",{className:"border-t pt-4 text-sm text-gray-500",children:[(0,r.jsxs)("p",{children:["Owner: ",e.owner]}),(0,r.jsxs)("p",{children:["Spot ID: #",e.id]})]})]})]})}function m(){(0,n.useParams)().spotId;let[e,s]=(0,a.useState)(!1),[t,l]=(0,a.useState)(null),[o,d]=(0,a.useState)(null),[c,m]=(0,a.useState)(!0);return c?r.jsx("main",{className:"min-h-screen p-8 bg-gray-50",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:r.jsx(BookingLoading,{})})}):error||!o?r.jsx("main",{className:"min-h-screen p-8 bg-gray-50",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("p",{className:"text-red-600 mb-2",children:"Error loading spot"}),r.jsx("p",{className:"text-sm text-gray-500",children:error||"Spot not found"})]})})}):e?r.jsx(BookingErrorBoundary,{children:r.jsx("main",{className:"min-h-screen p-8 bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[r.jsx(u,{spot:o}),r.jsx(x,{spot:o,userAddress:t})]})})}):r.jsx("main",{className:"min-h-screen p-8 bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[r.jsx(u,{spot:o}),(0,r.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow p-8 text-center",children:[r.jsx("p",{className:"text-lg text-gray-600 mb-6",children:"Please connect your wallet to book this parking spot"}),r.jsx(i.Z,{onConnect:e=>{l(e),s(!0)}})]})]})})}},9428:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(10326);function a({onConnect:e}){let s=async()=>{e("0x1234567890123456789012345678901234567890")};return r.jsx("button",{onClick:s,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Connect Wallet"})}},81917:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var r=t(10326),a=t(17577),n=t(97885);function i({bookingId:e,spotId:s,spotLocation:t,signature:i,signerAddress:l,timestamp:o,onSave:d}){let[c,x]=(0,a.useState)(!1),u=(0,a.useMemo)(()=>JSON.stringify({bookingId:e,spotId:s,location:t,timestamp:o||Date.now(),type:"parking_access",signature:i,signerAddress:l}),[e,s,t,i,l,o]);return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 md:p-8 text-center max-w-sm mx-auto w-full",children:[r.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Your Booking QR Code"}),r.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Show this QR code at the parking location for access"}),r.jsx("div",{className:"bg-gray-50 rounded-lg p-4 md:p-6 inline-block mb-6 w-full flex justify-center",children:r.jsx("div",{className:"bg-white p-4 rounded-lg inline-block border-2 border-gray-300",children:r.jsx(n.ZP,{id:"qr-code-canvas",value:u,size:200,level:"H",includeMargin:!0,className:"w-full h-auto"})})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:["Booking ID: ",r.jsx("span",{className:"font-mono font-medium break-all",children:e})]}),i&&(0,r.jsxs)("p",{className:"mt-2 text-xs text-green-600 flex items-center justify-center gap-1",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Digitally Signed"]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center pt-4",children:[r.jsx("button",{onClick:()=>{x(!0);let s=document.getElementById("qr-code-canvas");if(s){let t=s.toDataURL("image/png"),r=document.createElement("a");r.download=`booking-${e}-qr.png`,r.href=t,r.click()}x(!1),d&&d()},disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors w-full sm:w-auto",children:c?"Downloading...":"Save QR Code"}),r.jsx("button",{onClick:()=>window.print(),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors w-full sm:w-auto",children:"Print"})]})]})]})}},52957:(e,s,t)=>{"use strict";t.d(s,{AppKitProvider:()=>g});var r=t(10326),a=t(32355),n=t(22662),i=t(67338),l=t(60865),o=t(94243),d=t(22852),c=t(44976);let x=process.env.NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID||"",u=new n.K({networks:[i.$,l.D],projectId:x}),m={adapters:[u],networks:[i.$,l.D],projectId:x,metadata:{name:"CarIn",description:"Decentralized parking spot booking on Celo",url:"https://carin.app",icons:["https://carin.app/icon.png"]},features:{analytics:!0,email:!1,socials:[]},themeMode:"light",defaultNetwork:i.$},p=new d.S;function g({children:e}){return r.jsx(o.F,{config:u.wagmiConfig,children:r.jsx(c.aH,{client:p,children:r.jsx(a.Vd,{...m,children:e})})})}},46636:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`C:\Users\MSI\Desktop\walletconnect\CarIn\frontend\app\booking\[spotId]\page.tsx#default`)},54579:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o,metadata:()=>l});var r=t(19510),a=t(77366),n=t.n(a);t(67272);let i=(0,t(68570).createProxy)(String.raw`C:\Users\MSI\Desktop\walletconnect\CarIn\frontend\lib\providers\AppKitProvider.tsx#AppKitProvider`),l={title:"CarIn - Decentralized Parking",description:"Real-time parking spot booking on Celo blockchain"};function o({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:n().className,children:r.jsx(i,{children:e})})})}},67272:()=>{},82094:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[9276,2737,7885],()=>t(6610));module.exports=r})();